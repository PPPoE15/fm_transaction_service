key: FJ
tasks:
- checkout:
    force-clean-build: 'true'
    description: Git Checkout of ${bamboo.shortPlanName} repos
- inject-variables: 'bamboo-vars/.env-common'
- inject-variables: !include 'tasks/inject-vars-release.yml'
- inject-variables: !include 'tasks/inject-vars-master.yml'
- inject-variables: !include 'tasks/inject-vars-rc.yml'
- inject-variables: !include 'tasks/inject-vars-dev.yml'
- script:
    interpreter: SHELL
    file: bamboo-specs/scripts/build_pre_cached_image.sh
    environment: artifactory_docker=${bamboo.artifactory_docker} python_pip_image=${bamboo.inject.python_pip_image} YCSApub=${bamboo.secretYCSApub} YCSApriv=${bamboo.secretYCSApriv} python_pip_req_services=${bamboo.inject.python_pip_req_services} username=${bamboo.secret_username} password=${bamboo.secret_password} yandex_url_docker=${bamboo.inject.yandex_url_docker} yandex_registry_id=${bamboo.inject.yandex_registry_id}
    description: build pre-cached image
    conditions: !include 'tasks/skip-build-condition.yml'
final-tasks:
- script:
    interpreter: SHELL
    file: bamboo-specs/scripts/final_req_script.sh
    environment: artifactory_docker=${bamboo.artifactory_docker} python_pip_image=${bamboo.python_pip_image} python_pip_req_services=${bamboo.python_pip_req_services}
    description: clean up containers
    conditions: !include 'tasks/skip-build-condition.yml'
- clean:
    description: clean up
requirements:
- system.builder.command.Docker-compose
artifact-subscriptions: []
